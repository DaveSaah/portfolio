---
import { BlogPostDetailScreen } from '@/features/blog';
import { type LanguageCode } from '@/i18n/ui';
import { getCollection, render } from 'astro:content';

let lang = 'en' as LanguageCode;

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog', ({ data }) => {
    return data.isDraft !== true && data.lang === 'en';
  });
  return blogEntries.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;

const { Content, remarkPluginFrontmatter } = await render(post);
---

<BlogPostDetailScreen
  post={{
    ...post.data,
    readingTimeMinutes: remarkPluginFrontmatter.readingTimeMinutes,
  }}
  lang={lang}
  filePath={post.filePath ? post.filePath : ''}
>
  <Content />
</BlogPostDetailScreen>
